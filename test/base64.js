const assert = require('assert');
const should = require('should');

const base64 = require('../helpers/base64.js');

const publickey = {
	raw 	: '-----BEGIN CERTIFICATE-----\nMIIFnTCCA4WgAwIBAgIJAPIyvyuXhflmMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNV\n'
			+'BAYTAkRLMQswCQYDVQQIDAJOQTETMBEGA1UEBwwKQ29wZW5oYWdlbjEgMB4GA1UE\nCgwXU2Nob3VnYWFyZCBUZWNobm9sb2d'
			+'pZXMxEjAQBgNVBAMMCWxvY2FsaG9zdDAe\nFw0xNjAxMTIxNDQzMDNaFw0yNjAxMDkxNDQzMDNaMGUxCzAJBgNVBAYTAkRLMQ'
			+'sw\nCQYDVQQIDAJOQTETMBEGA1UEBwwKQ29wZW5oYWdlbjEgMB4GA1UECgwXU2Nob3Vn\nYWFyZCBUZWNobm9sb2dpZXMxEjA'
			+'QBgNVBAMMCWxvY2FsaG9zdDCCAiIwDQYJKoZI\nhvcNAQEBBQADggIPADCCAgoCggIBAMQZLzrApEGXg9zu6bjhR+njAXiTro'
			+'dMYUyq\nDFoYElxqcRQlz0AeyK4KpG6Eyqgo6du9sLlV3teImvqE7apuSrRJbVLZQOyUNoZh\nGG2ksRxeOYwbxN0nF4QxoSz'
			+'0N1t5uumtg83GvuUc0xzezFxfzyfpMprIZbsT5RIP\nKSxIowplIHkS8T9AxREsqXzSu9NZx7m34HKUGYfvzNs0ZEeb6Pr0Db'
			+'nFfq9zZ2xZ\nx4MR21oMn+Vqfm7B9oQmmtlFSiY7AwYTppabVYhsDGfRNvMzYpp0tm0Z60JBXpqA\nldgsS4NkVYuohIMPAEu'
			+'DZ1jMX6aH+q6+pQxTT5Sc2UX6m8wn+sxFDs7gdNFd5KxE\nZZGgo0dYTHRL0KjvYN04p/V8W/7doJ+zAHwT8TM59hR5LUmw7q'
			+'5IGKJK781BPerq\ntU52eBQmNOImyoUQ1Fnwn09wFqQ2UFknOYxLWOtLUny+zyjRKLNsH6OQrAV33SQF\nNNU3nfwNnw9tDAe'
			+'F0NI/K18z8SJf/GJSTQPNpRxHyGH6awpxrDu7qbtgtRHX7KOo\narV4B4XbIGl8k3oam4YT3gSnOeuyuB6bKCQ3FCfcaGZYfF'
			+'/vZ+yKoDGpwkZ7tbPW\nDNRXP6yTQv8f5IAa/PfrfJvGbybfI/RtJ2f/pFdtuvITOP7PPFeH5AVRBMZg9MLw\nrTRZNBP/AgM'
			+'BAAGjUDBOMB0GA1UdDgQWBBTH53dBvks3yCAuTdWcXu20aDObbjAf\nBgNVHSMEGDAWgBTH53dBvks3yCAuTdWcXu20aDObbj'
			+'AMBgNVHRMEBTADAQH/MA0G\nCSqGSIb3DQEBCwUAA4ICAQCG3blm2lYoliCu5tlOnO+Af6Vyd8/QzpTN+qSjVEPN\nMUtxcCg'
			+'sLZxX+CHsROy8tbCrvTQb/NPUMovLwTm4sooYrLAZDPyVwWJ8l0MU0u01\nlBr2vNSK1s206Nomcl11+MQTsEQH2NfU2V4QH/'
			+'d9cP6Z/zaxkO8w3MHYTMBDcd95\nzTrDRSTHP0oXWWE7ybYroUv1pQJIHZhe00x9zs0lrZFNR2DySiucdqiUtRrJ2r02\nKWk'
			+'eZno0dZEJS3uzOqgV7IYmfqiPBloW5GPkZX9vu61IZI87nBHZa+NDfPyTimpJ\n34IXrHVvW75VZAzBNSE+SxkHzxDBAqJ1Aj'
			+'UTTIb3pWo79bCWbsBCWyu6S7cC8+oe\n8aO9bAw4JwWBC7hfJYWZLuHhf2nFlFxYWctLpFOj8KCP2/WsiiHdFJPvW0gK/uuh'
			+'\nynjI9sWT0+mIqhwAIEO6F7CCz9HmEaWyOsaud4xHstc9u0CRo7+Ci/yTIxpiVVNz\n59mTRvBiNdan6tW3KCHmotc0xJeOI'
			+'DR7yckFyBKpMhX2UQ2SUPmIpf9JjbJDHvCX\n1V0588p9Lxm3K4DzxkG/6X+l+jXBVHRar3BYzzH0SubyU3oQu+D8+mFcR+bg'
			+'W/ZD\nuaA4vcPd6zMil9/Xv4/raCCjFXhZftGwjAJ+xb3qoe7fALn2zqApUCkydlbcog7m\nFg==\n-----END CERTIFICAT'
			+'E-----\n',
	base64 	: 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tXG5NSUlGblRDQ0E0V2dBd0lCQWdJSkFQSXl2eXVYaGZsbU1BMEdDU3FHU0li'
			+'M0RRRUJDd1VBTUdVeEN6QUpCZ05WXG5CQVlUQWtSTE1Rc3dDUVlEVlFRSURBSk9RVEVUTUJFR0ExVUVCd3dLUTI5d1pXNW9ZV'
			+'2RsYmpFZ01CNEdBMVVFXG5DZ3dYVTJOb2IzVm5ZV0Z5WkNCVVpXTm9ibTlzYjJkcFpYTXhFakFRQmdOVkJBTU1DV3h2WTJGc2'
			+'FHOXpkREFlXG5GdzB4TmpBeE1USXhORFF6TUROYUZ3MHlOakF4TURreE5EUXpNRE5hTUdVeEN6QUpCZ05WQkFZVEFrUkxNUXN'
			+'3XG5DUVlEVlFRSURBSk9RVEVUTUJFR0ExVUVCd3dLUTI5d1pXNW9ZV2RsYmpFZ01CNEdBMVVFQ2d3WFUyTm9iM1ZuXG5ZV0Z5'
			+'WkNCVVpXTm9ibTlzYjJkcFpYTXhFakFRQmdOVkJBTU1DV3h2WTJGc2FHOXpkRENDQWlJd0RRWUpLb1pJXG5odmNOQVFFQkJRQ'
			+'URnZ0lQQURDQ0Fnb0NnZ0lCQU1RWkx6ckFwRUdYZzl6dTZiamhSK25qQVhpVHJvZE1ZVXlxXG5ERm9ZRWx4cWNSUWx6MEFleU'
			+'s0S3BHNkV5cWdvNmR1OXNMbFYzdGVJbXZxRTdhcHVTclJKYlZMWlFPeVVOb1poXG5HRzJrc1J4ZU9Zd2J4TjBuRjRReG9TejB'
			+'OMXQ1dXVtdGc4M0d2dVVjMHh6ZXpGeGZ6eWZwTXBySVpic1Q1UklQXG5LU3hJb3dwbElIa1M4VDlBeFJFc3FYelN1OU5aeDdt'
			+'MzRIS1VHWWZ2ek5zMFpFZWI2UHIwRGJuRmZxOXpaMnhaXG54NE1SMjFvTW4rVnFmbTdCOW9RbW10bEZTaVk3QXdZVHBwYWJWW'
			+'WhzREdmUk52TXpZcHAwdG0wWjYwSkJYcHFBXG5sZGdzUzROa1ZZdW9oSU1QQUV1RFoxak1YNmFIK3E2K3BReFRUNVNjMlVYNm'
			+'04d24rc3hGRHM3Z2RORmQ1S3hFXG5aWkdnbzBkWVRIUkwwS2p2WU4wNHAvVjhXLzdkb0orekFId1Q4VE01OWhSNUxVbXc3cTV'
			+'JR0tKSzc4MUJQZXJxXG50VTUyZUJRbU5PSW15b1VRMUZud24wOXdGcVEyVUZrbk9ZeExXT3RMVW55K3p5alJLTE5zSDZPUXJB'
			+'VjMzU1FGXG5OTlUzbmZ3Tm53OXREQWVGME5JL0sxOHo4U0pmL0dKU1RRUE5wUnhIeUdINmF3cHhyRHU3cWJ0Z3RSSFg3S09vX'
			+'G5hclY0QjRYYklHbDhrM29hbTRZVDNnU25PZXV5dUI2YktDUTNGQ2ZjYUdaWWZGL3ZaK3lLb0RHcHdrWjd0YlBXXG5ETlJYUD'
			+'Z5VFF2OGY1SUFhL1BmcmZKdkdieWJmSS9SdEoyZi9wRmR0dXZJVE9QN1BQRmVINUFWUkJNWmc5TUx3XG5yVFJaTkJQL0FnTUJ'
			+'BQUdqVURCT01CMEdBMVVkRGdRV0JCVEg1M2RCdmtzM3lDQXVUZFdjWHUyMGFET2JiakFmXG5CZ05WSFNNRUdEQVdnQlRINTNk'
			+'QnZrczN5Q0F1VGRXY1h1MjBhRE9iYmpBTUJnTlZIUk1FQlRBREFRSC9NQTBHXG5DU3FHU0liM0RRRUJDd1VBQTRJQ0FRQ0czY'
			+'mxtMmxZb2xpQ3U1dGxPbk8rQWY2VnlkOC9RenBUTitxU2pWRVBOXG5NVXR4Y0Nnc0xaeFgrQ0hzUk95OHRiQ3J2VFFiL05QVU'
			+'1vdkx3VG00c29vWXJMQVpEUHlWd1dKOGwwTVUwdTAxXG5sQnIydk5TSzFzMjA2Tm9tY2wxMStNUVRzRVFIMk5mVTJWNFFIL2Q'
			+'5Y1A2Wi96YXhrTzh3M01IWVRNQkRjZDk1XG56VHJEUlNUSFAwb1hXV0U3eWJZcm9VdjFwUUpJSFpoZTAweDl6czBsclpGTlIy'
			+'RHlTaXVjZHFpVXRSckoycjAyXG5LV2tlWm5vMGRaRUpTM3V6T3FnVjdJWW1mcWlQQmxvVzVHUGtaWDl2dTYxSVpJODduQkhaY'
			+'StORGZQeVRpbXBKXG4zNElYckhWdlc3NVZaQXpCTlNFK1N4a0h6eERCQXFKMUFqVVRUSWIzcFdvNzliQ1dic0JDV3l1NlM3Y0'
			+'M4K29lXG44YU85YkF3NEp3V0JDN2hmSllXWkx1SGhmMm5GbEZ4WVdjdExwRk9qOEtDUDIvV3NpaUhkRkpQdlcwZ0svdXVoXG5'
			+'5bmpJOXNXVDArbUlxaHdBSUVPNkY3Q0N6OUhtRWFXeU9zYXVkNHhIc3RjOXUwQ1JvNytDaS95VEl4cGlWVk56XG41OW1UUnZC'
			+'aU5kYW42dFczS0NIbW90YzB4SmVPSURSN3lja0Z5QktwTWhYMlVRMlNVUG1JcGY5SmpiSkRIdkNYXG4xVjA1ODhwOUx4bTNLN'
			+'ER6eGtHLzZYK2wralhCVkhSYXIzQll6ekgwU3VieVUzb1F1K0Q4K21GY1IrYmdXL1pEXG51YUE0dmNQZDZ6TWlsOS9YdjQvcm'
			+'FDQ2pGWGhaZnRHd2pBSit4YjNxb2U3ZkFMbjJ6cUFwVUNreWRsYmNvZzdtXG5GZz09XG4tLS0tLUVORCBDRVJUSUZJQ0FURS0'
			+'tLS0tXG4='
}

describe('Base64 Encoding and Decoding', function(){
	var base64Encoded = '';
	it('should be base64 encoded after invoking encode()', function(done){
		base64Encoded = base64.encode(publickey.raw);
		base64Encoded.should.match(/^([A-Za-z0-9+\/]{4})*([A-Za-z0-9+\/]{4}|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{2}==)$/);
		done();
	});

	it('should be equal to orignal after invoking decode()', function(done){
		(base64.decode(base64Encoded)).should.equal(publickey.raw);
		done();
	})
});